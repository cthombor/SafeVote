<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="Experimental fork of vote_2.3-2, with SafeRank and safety tests. ">
<title>Election Vote Counting with Safety Features • SafeVote</title>
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.1.3/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.1.3/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Election Vote Counting with Safety Features">
<meta property="og:description" content="Experimental fork of vote_2.3-2, with SafeRank and safety tests. ">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="index.html">SafeVote</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.99</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="reference/index.html">Reference</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header"><h1 id="safevote">SafeVote<a class="anchor" aria-label="anchor" href="#safevote"></a>
</h1></div>
<!-- badges: start -->
<!-- badges: end -->
<p>The goals of SafeVote are to investigate the safety of announcing preliminary results from an election, and to allow experimental study of the safety of a complete ranking of all candidates (as in a party list) that is derived from a small-scale election with preferential ballots.</p>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>You can install the development version of SafeVote from <a href="https://github.com/" class="external-link">GitHub</a> with:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install.packages("devtools")</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"cthombor/SafeVote"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="examples">Examples<a class="anchor" aria-label="anchor" href="#examples"></a>
</h2>
<p>This mod of <a href="https://cran.r-project.org/web/packages/vote/index.html" class="external-link">vote.2.3-2</a> reports the margins of victory in an election.</p>
<p>The value of the <code>safety</code> parameter will affect the completeness of the safeRank ordering of the candidates. Setting <code>safety = 0</code> will cause safeRank to be a total ranking of the candidates, except in the rare case that there is an exact tie. The “fuzz” <span class="math inline"><em>z</em></span> on the vote-differentials in a safeRank clustering of the candidates is <span class="math inline">$z = s\sqrt{n}$</span>, where <span class="math inline"><em>s</em></span> is the value of the safety parameter and <span class="math inline"><em>n</em></span> is the number of ballots.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>    <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://cthombor.github.io/SafeVote/">SafeVote</a></span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">food_election</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="reference/stv.html">stv</a></span><span class="op">(</span><span class="va">food_election</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="reference/stv.html">stv</a></span><span class="op">(</span><span class="va">food_election</span>, safety<span class="op">=</span><span class="fl">0.25</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="reference/stv.html">stv</a></span><span class="op">(</span><span class="va">food_election</span>, safety<span class="op">=</span><span class="fl">0</span><span class="op">)</span></span></code></pre></div>
<p>A few safety-testing routines are supplied, to support experimental study of the statistical behaviour of ballot counting methods. For example, <code>testFraction</code> draws a series of independent samples from a ballot box, which we expect to be helpful in estimating the number of ballots required to form a stable result. As seen below, in the case of the <a href="dublin_west">dublin_west</a> dataset, only a few thousand ballots are sufficient to reliably determine the three winners (Lenihan, Higgins, Burton). By contrast, the relative ranking of Ryan and Morrissey is still somewhat unstable when the last few thousands of ballots are being counted.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">dublin_west</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="reference/testFraction.html">testFraction</a></span><span class="op">(</span><span class="va">dublin_west</span>,astart<span class="op">=</span><span class="fl">8</span>,ainc<span class="op">=</span><span class="fl">20</span>,countArgs<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>nseats<span class="op">=</span><span class="fl">3</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/testFraction.png"></p>
<p><a href="testAdditions">testAdditions</a> can be used to assess the sensitivity of an STV election to a tactical-voting strategy of “plumping” for a favoured candidate. For example, we find it takes only two “plumping” ballots to shift “Strawberries” from third place to second place in the <a href="food_election">food_election</a> dataset. Note that in this test we have set the <code>safety</code> parameter of the <a href="stv">stv</a> ballot-counting method to zero, so that the output of <a href="testAdditions">testAdditions</a> reveals a complete ranking of the candidates unless there is an exact tie.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">food_election</span><span class="op">)</span> </span>
<span><span class="fu"><a href="reference/testAdditions.html">testAdditions</a></span><span class="op">(</span><span class="va">food_election</span>, arep <span class="op">=</span> <span class="fl">2</span>, favoured <span class="op">=</span> <span class="st">"Strawberries"</span>, </span>
<span>  countArgs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>safety <span class="op">=</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Adding up to 2 stv ballots = ( 3 5 4 1 2 )</span></span>
<span><span class="co">#&gt; Testing progress:  1, 2</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Results of testAdditions at 2022-12-26 08:25:22</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Dataset = food_election, countMethod = stv, rankMethod = safeRank</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; |          | safety|</span></span>
<span><span class="co">#&gt; |:---------|------:|</span></span>
<span><span class="co">#&gt; |countArgs |      0|</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; |             | ainc| arep|                                                         tacticalBallot|</span></span>
<span><span class="co">#&gt; |:------------|----:|----:|----------------------------------------------------------------------:|</span></span>
<span><span class="co">#&gt; |otherFactors |    1|    2| c(Oranges = 3, Pears = 5, Chocolate = 4, Strawberries = 1, Sweets = 2)|</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Experiment ID, number of ballots in simulated election, ranks, winning margins:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; |exptID | nBallots| Oranges| Pears| Chocolate| Strawberries| Sweets| m.Oranges| m.Pears| m.Chocolate| m.Strawberries|  m.Sweets|</span></span>
<span><span class="co">#&gt; |:------|--------:|-------:|-----:|---------:|------------:|------:|---------:|-------:|-----------:|--------------:|---------:|</span></span>
<span><span class="co">#&gt; |SBK0   |       20|       2|     5|         1|            3|      4| 1.4451111|       2|           8|      1.7774444| 0.7774444|</span></span>
<span><span class="co">#&gt; |SBK1   |       21|       2|     5|         1|            3|      4| 0.6673333|       2|           8|      2.6663333| 0.6663333|</span></span>
<span><span class="co">#&gt; |SBK2   |       22|       3|     5|         1|            2|      4| 3.4447778|       2|           8|      0.1104444| 0.5552222|</span></span></code></pre></div>
<p><a href="testDeletions">testDeletions</a> deletes ballots sequentially from the ballot box, counting after each deletion. When its results are plotted in inverse order of collection (i.e. in <em>increasing</em> order of the number of ballots <span class="math inline"><em>n</em></span>) we see a possible evolution of the preliminary results from an election in which the initial order of ballots in the ballot box had been randomised. Note that a plot of the results of <a href="testFraction">testFraction</a> has quite a similar appearance, however the ballot boxes counted in <a href="testFraction">testFraction</a> are independently sampled (“bootstrapped”) from the full dataset of ballots. By contrast, <a href="testDeletions">testDeletions</a> samples without replacement from the original ballot box, when constructing its next experimental unit.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>    <span class="va">xr</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/testDeletions.html">testDeletions</a></span><span class="op">(</span><span class="va">dublin_west</span>,dinc<span class="op">=</span><span class="fl">25</span>,dstart<span class="op">=</span><span class="fl">29988</span>,quiet<span class="op">=</span><span class="cn">FALSE</span>,</span>
<span>      countArgs<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>safety<span class="op">=</span><span class="fl">0.0</span>,complete.ranking<span class="op">=</span><span class="cn">TRUE</span>,nseats<span class="op">=</span><span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/save.html" class="external-link">save</a></span><span class="op">(</span><span class="va">xr</span>,file<span class="op">=</span><span class="st">"../s0di25ns3.rdata"</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">xr</span>,title<span class="op">=</span><span class="st">"testDeletions, file = s0di25ns3"</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/s0di25ns3.png"></p>
<p>In the plots above, the “adjusted rank” of a candidate is their ranking <span class="math inline"><em>r</em></span> plus their scaled margin of victory. Because the most-popular candidate is at rank 1, we invert the usual convention for the x-axis on Cartesian plots so that the first-elected candidate appears first in the legend and their scaled margin is the uppermost. Because margin of victory <span class="math inline"><em>m</em></span> must be non-negative but it may be quite a large number; and because it is only the small margins of victory which affect the safety of an election result: we compute a scaled margin as <span class="math inline">$e^{-cm/\sqrt{n}}$</span>. This exponential adjustment hugely accentuates the visual importance of the margins that are comparable in magnitude to the square root of the number of ballots <span class="math inline"><em>n</em></span> multiplied by the number of seats <span class="math inline"><em>s</em></span>) – which is a rough proxy for the standard deviation of a candidate’s margin of victory in an election where at least some voters are marking their ballots essentially at random. The margin-scaling parameter <span class="math inline"><em>c</em></span> may be adjusted using the parameter <code>cMargin</code> of <a href="plot.SafeVote">plot.SafeVote</a>. Note that Morrissey’s adjusted rank is visually very close to McDonald’s adjusted rank when most of the ballots have been counted in the sample testDeletions plot above, suggesting (correctly!) that relatively small variations in voter behaviour could affect their relative ranking.</p>
</div>
</div>
  </main><aside class="col-md-3"><div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li>GPL (&gt;= 2)</li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing SafeVote</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Clark Thomborson <br><small class="roles"> Maintainer </small>  </li>
</ul>
</div>



  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Clark Thomborson.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
