<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content='The votes parameter is as described in the Details for condorcet() with the following additional semantics.
If a ballot fails to rank all candidates, it is informal (i.e. "invalid")
unless invalid.partial=FALSE. If a ballot has equally-ranked candidates, it
is informal unless equal.preferences=TRUE. Informal ballots are removed
from the ballot box before counting, a warning is issued,
and the ballots'><title>Count preferential ballots using an STV method — stv • SafeVote</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Count preferential ballots using an STV method — stv"><meta property="og:description" content='The votes parameter is as described in the Details for condorcet() with the following additional semantics.
If a ballot fails to rank all candidates, it is informal (i.e. "invalid")
unless invalid.partial=FALSE. If a ballot has equally-ranked candidates, it
is informal unless equal.preferences=TRUE. Informal ballots are removed
from the ballot box before counting, a warning is issued,
and the ballots'><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">SafeVote</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.99</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"></ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Count preferential ballots using an STV method</h1>
      
      <div class="d-none name"><code>stv.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>The <code>votes</code> parameter is as described in the <a href="condorcet.html#details">Details for condorcet()</a> with the following additional semantics.
If a ballot fails to rank all candidates, it is informal (<em>i.e.</em> "invalid")
unless <code>invalid.partial=FALSE</code>. If a ballot has equally-ranked candidates, it
is informal unless <code>equal.preferences=TRUE</code>. Informal ballots are removed
from the ballot box before counting, a warning is issued,
and the ballots</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">stv</span><span class="op">(</span></span>
<span>  <span class="va">votes</span>,</span>
<span>  nseats <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  eps <span class="op">=</span> <span class="fl">0.001</span>,</span>
<span>  equal.ranking <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  fsep <span class="op">=</span> <span class="st">"\t"</span>,</span>
<span>  ties <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"f"</span>, <span class="st">"b"</span><span class="op">)</span>,</span>
<span>  constant.quota <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  quota.hare <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  group.nseats <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  group.members <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  complete.ranking <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  invalid.partial <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  seed <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  quiet <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  digits <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  backwards.compatible <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  safety <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>votes</dt>
<dd><p>an array with one column per candidate and one row per ballot,
as described in the <a href="condorcet.html#details">Details for condorcet()</a></p></dd>


<dt>nseats</dt>
<dd><p>the number of seats to be filled in this election</p></dd>


<dt>eps</dt>
<dd><p>fuzz-factor when comparing fractional votes</p></dd>


<dt>equal.ranking</dt>
<dd><p>= FALSE,</p></dd>


<dt>fsep</dt>
<dd><p>column-separator for output</p></dd>


<dt>ties</dt>
<dd><p>vector of tie-breaking methods: <code>'f'</code> for forward, <code>'b'</code> for
backward</p></dd>


<dt>constant.quota</dt>
<dd><p><code>TRUE</code> if quota is held constant.  Over-rides
quota.hare. Default is <code>FALSE</code>.</p></dd>


<dt>quota.hare</dt>
<dd><p><code>TRUE</code> if Hare quota, <code>FALSE</code> if Droop quota (default)</p></dd>


<dt>group.nseats</dt>
<dd><p>number of seats reserved to members of a group, as in the
Church of England's STV methodology.</p></dd>


<dt>group.members</dt>
<dd><p>vector of members of a group with reserved seats</p></dd>


<dt>complete.ranking</dt>
<dd><p><code>TRUE</code> (default) if a complete ranking of all
candidates will be produced.  This parameter affects the value assigned to
<code>nseats</code> when <code>stv()</code> is called with <code>nseats=NULL</code>, but has no effect on
elections in which <code>nseats</code> is explicitly specified.</p></dd>


<dt>invalid.partial</dt>
<dd><p><code>TRUE</code> if ballots which do not specify a complete
ranking of candidates are informal (aka "invalid") <em>i.e.</em> ignored
(with a warning).  Default is <code>FALSE</code>.</p></dd>


<dt>verbose</dt>
<dd><p><code>TRUE</code> for diagnostic output</p></dd>


<dt>seed</dt>
<dd><p>integer seed for tie-breaking.  Warning: if non-<code>NULL</code>, the PRNG
for R is reseeded prior to <em>every</em> random tie-break among the
possibly-elected candidates.  We have preserved this functionality in this
branch to allow regression against the legacy codebase of
<a href="https://cran.r-project.org/web/packages/vote/index.html" class="external-link">vote_2.3.2</a>. In
<a href="SafeVote-package.html">SafeVote</a> the default value for seed is <code>NULL</code> rather than the legacy
value of 1234, to mitigate the validity hazard of PRNG reseedings during a
stochastic experiment.</p></dd>


<dt>quiet</dt>
<dd><p><code>TRUE</code> to suppress console output</p></dd>


<dt>digits</dt>
<dd><p>number of significant digits in the output table</p></dd>


<dt>backwards.compatible</dt>
<dd><p><code>TRUE</code> to regress against vote2_3.2 by
disabling $margins, $fuzz, $rankingTable, $safeRank</p></dd>


<dt>safety</dt>
<dd><p>number of standard deviations on vote-counts, when producing a
safeRank by clustering near-ties in a complete ranking</p></dd>


<dt>...</dt>
<dd><p>undocumented intent (preserved from legacy code)</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>object of class <code>vote.stv</code>.  Note: the winning margins in this object
are valid for the elected candidates and their (total) ranking, but must be
adjusted within tiegroups to be valid for the candidates' (possibly
partial) safeRank.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">food_election</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">stv</span><span class="op">(</span><span class="va">food_election</span>, safety <span class="op">=</span> <span class="fl">0.0</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Results of Single transferable vote</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ===================================                           </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of valid votes:   20</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of invalid votes:  0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of candidates:     5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of seats:          2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Fuzz on safeRank:	 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Complete ranking:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |             | Rank|SafeRank |  Margin   |</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |:------------|----:|:--------|:---------:|</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |Oranges      |    2|2        | 1.4451111 |</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |Pears        |    4|4        |    NA     |</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |Chocolate    |    1|1        | 8.0000000 |</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |Strawberries |    3|3        | 1.7774444 |</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |Sweets       |    3|3        | 0.7774444 |</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Vote transfers:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |             |         1| 2-trans|     2| 3-trans|      3| 4-trans|       4|</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |:------------|---------:|-------:|-----:|-------:|------:|-------:|-------:|</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |Oranges      |     4.000|   0.000| 4.000|       2|  6.000|   0.000|   6.000|</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |Pears        |     2.000|   0.000| 2.000|      -2|       |        |        |</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |Chocolate    |    12.000|  -5.332|      |        |       |        |        |</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |Strawberries |     1.000|   3.555| 4.555|       0|  4.555|   0.000|   4.555|</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |Sweets       |     1.000|   1.777| 2.777|       0|  2.777|  -2.777|        |</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |Tie-breaks   |          |        |      |        |       |        |        |</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |Elected      | Chocolate|        |      |        |       |        | Oranges|</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |Eliminated   |          |        | Pears|        | Sweets|        |        |</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Elected: Chocolate, Oranges </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="fu">stv</span><span class="op">(</span><span class="va">food_election</span>, nseats <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Results of Single transferable vote</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ===================================                           </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of valid votes:   20</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of invalid votes:  0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of candidates:     5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of seats:          2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Fuzz on safeRank:	 4.472136</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Complete ranking:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |             | Rank|SafeRank |  Margin   |</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |:------------|----:|:--------|:---------:|</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |Oranges      |    2|2        | 1.4451111 |</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |Pears        |    4|2        |    NA     |</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |Chocolate    |    1|1        | 8.0000000 |</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |Strawberries |    3|2        | 1.7774444 |</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |Sweets       |    3|2        | 0.7774444 |</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Vote transfers:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |             |         1| 2-trans|     2| 3-trans|      3| 4-trans|       4|</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |:------------|---------:|-------:|-----:|-------:|------:|-------:|-------:|</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |Oranges      |     4.000|   0.000| 4.000|       2|  6.000|   0.000|   6.000|</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |Pears        |     2.000|   0.000| 2.000|      -2|       |        |        |</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |Chocolate    |    12.000|  -5.332|      |        |       |        |        |</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |Strawberries |     1.000|   3.555| 4.555|       0|  4.555|   0.000|   4.555|</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |Sweets       |     1.000|   1.777| 2.777|       0|  2.777|  -2.777|        |</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |Tie-breaks   |          |        |      |        |       |        |        |</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |Elected      | Chocolate|        |      |        |       |        | Oranges|</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |Eliminated   |          |        | Pears|        | Sweets|        |        |</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Elected: Chocolate, Oranges </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Clark Thomborson.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

